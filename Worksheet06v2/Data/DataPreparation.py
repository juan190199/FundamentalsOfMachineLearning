import numpy as npimport pandas as pdimport osdef dataPreparation():    # Load dataset    filename = os.path.join('data', 'CrowdstormingDataJuly1st.csv')    df = pd.read_csv(filename, sep=",", header=0)    print(df.columns)    print("Shape of the raw data: ", df.shape)    mask = pd.notnull(df['photoID'])    print("Number of missing photo IDs", df.shape[0] - np.sum(mask))    # Drop rows with missing IDs    df = df.loc[mask]    assert np.sum(pd.isnull(df['rater1'])) == 0    assert np.sum(pd.isnull(df['rater2'])) == 0    print("Number of unique playerShorts: ", np.unique(df['playerShort']).shape)    print("Number of unique players: ", np.unique(df['player']).shape)    print("Number of unique refCountrys:", np.unique(df['refCountry']).shape)    print("Number of unique Alpha_3s:", len(df['Alpha_3'].unique()))    # Drop irrelevant features    # photoID: holds no relevant information    # meanIAT, nIAT, seIAT, meanEXP, nExp, seEXP: These values stand for racial biases in the referee countries.    # Hence of no interest for our problem    # yellowCards: Only interested in the number of red cards    # Alpha_3: Abbreviations for the referee countrys are redundant    irrelevant_feats = ['photoID', 'Alpha_3', 'yellowCards',                        'meanIAT', 'nIAT', 'nIAT', 'seIAT', 'meanExp', 'nExp', 'seExp', 'refNum', 'refCountry']    df.drop(irrelevant_feats, axis=1, inplace=True)    print("Shape of dataset after dropping irrelevant features: ", df.shape)    # Drop all rows with missing values    df.dropna(axis=0, inplace=True)    print("Shape of dataset after dropping missing values:", df.shape)    gdf = df.groupby(['playerShort'])    variable_features = ['games', 'victories', 'ties', 'defeats', 'goals', 'yellowReds', 'redCards']    static_features = ['playerShort', 'player', 'club', 'leagueCountry', 'birthday', 'height', 'weight', 'position',                       'rater1', 'rater2']    variable_data = gdf[variable_features].sum()    static_data = df[static_features]    static_data = static_data.drop_duplicates()    df = variable_data.join(static_data.set_index('playerShort'), on='playerShort')    # Implementation of new features and targets from the dataset    df['rating'] = (df.loc[:, 'rater1'] + df.loc[:, 'rater2']) / 2    df.drop(['rater1', 'rater2'], axis=1, inplace=True)